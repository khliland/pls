<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>MSEP, RMSEP and R2 of PLSR and PCR models — mvrVal • pls</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="MSEP, RMSEP and R2 of PLSR and PCR models — mvrVal"><meta name="description" content="Functions to estimate the mean squared error of prediction (MSEP), root mean
squared error of prediction (RMSEP) and \(R^2\) (A.K.A. coefficient of
multiple determination) for fitted PCR and PLSR models.  Test-set,
cross-validation and calibration-set estimates are implemented."><meta property="og:description" content="Functions to estimate the mean squared error of prediction (MSEP), root mean
squared error of prediction (RMSEP) and \(R^2\) (A.K.A. coefficient of
multiple determination) for fitted PCR and PLSR models.  Test-set,
cross-validation and calibration-set estimates are implemented."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pls</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.9-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/khliland/pls/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>MSEP, RMSEP and R2 of PLSR and PCR models</h1>
      <small class="dont-index">Source: <a href="https://github.com/khliland/pls/blob/HEAD/R/mvrVal.R" class="external-link"><code>R/mvrVal.R</code></a></small>
      <div class="d-none name"><code>mvrVal.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Functions to estimate the mean squared error of prediction (MSEP), root mean
squared error of prediction (RMSEP) and \(R^2\) (A.K.A. coefficient of
multiple determination) for fitted PCR and PLSR models.  Test-set,
cross-validation and calibration-set estimates are implemented.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mvrValstats</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">estimate</span>,</span>
<span>  <span class="va">newdata</span>,</span>
<span>  ncomp <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">object</span><span class="op">$</span><span class="va">ncomp</span>,</span>
<span>  <span class="va">comps</span>,</span>
<span>  intercept <span class="op">=</span> <span class="va">cumulative</span>,</span>
<span>  se <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">R2</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'mvr'</span></span>
<span><span class="fu">R2</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">estimate</span>,</span>
<span>  <span class="va">newdata</span>,</span>
<span>  ncomp <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">object</span><span class="op">$</span><span class="va">ncomp</span>,</span>
<span>  <span class="va">comps</span>,</span>
<span>  intercept <span class="op">=</span> <span class="va">cumulative</span>,</span>
<span>  se <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">MSEP</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'mvr'</span></span>
<span><span class="fu">MSEP</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">estimate</span>,</span>
<span>  <span class="va">newdata</span>,</span>
<span>  ncomp <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">object</span><span class="op">$</span><span class="va">ncomp</span>,</span>
<span>  <span class="va">comps</span>,</span>
<span>  intercept <span class="op">=</span> <span class="va">cumulative</span>,</span>
<span>  se <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">RMSEP</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'mvr'</span></span>
<span><span class="fu">RMSEP</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>an <code>mvr</code> object</p></dd>


<dt id="arg-estimate">estimate<a class="anchor" aria-label="anchor" href="#arg-estimate"></a></dt>
<dd><p>a character vector.  Which estimators to use.  Should be a
subset of <code>c("all", "train", "CV", "adjCV", "test")</code>.  <code>"adjCV"</code>
is only available for (R)MSEP.  See below for how the estimators are chosen.</p></dd>


<dt id="arg-newdata">newdata<a class="anchor" aria-label="anchor" href="#arg-newdata"></a></dt>
<dd><p>a data frame with test set data.</p></dd>


<dt id="arg-ncomp-comps">ncomp, comps<a class="anchor" aria-label="anchor" href="#arg-ncomp-comps"></a></dt>
<dd><p>a vector of positive integers.  The components or number
of components to use.  See below.</p></dd>


<dt id="arg-intercept">intercept<a class="anchor" aria-label="anchor" href="#arg-intercept"></a></dt>
<dd><p>logical.  Whether estimates for a model with zero
components should be returned as well.</p></dd>


<dt id="arg-se">se<a class="anchor" aria-label="anchor" href="#arg-se"></a></dt>
<dd><p>logical.  Whether estimated standard errors of the estimates
should be calculated.  Not implemented yet.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further arguments sent to underlying functions or (for
<code>RMSEP</code>) to <code>MSEP</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>RMSEP</code> simply calls <code>MSEP</code> and takes the square root of the
estimates.  It therefore accepts the same arguments as <code>MSEP</code>.</p>
<p>Several estimators can be used.  <code>"train"</code> is the training or
calibration data estimate, also called (R)MSEC.  For <code>R2</code>, this is the
unadjusted \(R^2\).  It is overoptimistic and should not be used for
assessing models.  <code>"CV"</code> is the cross-validation estimate, and
<code>"adjCV"</code> (for <code>RMSEP</code> and <code>MSEP</code>) is the bias-corrected
cross-validation estimate.  They can only be calculated if the model has
been cross-validated.  Finally, <code>"test"</code> is the test set estimate,
using <code>newdata</code> as test set.</p>
<p>Which estimators to use is decided as follows (see below for
<code>mvrValstats</code>).  If <code>estimate</code> is not specified, the test set
estimate is returned if <code>newdata</code> is specified, otherwise the CV and
adjusted CV (for <code>RMSEP</code> and <code>MSEP</code>) estimates if the model has
been cross-validated, otherwise the training data estimate.  If
<code>estimate</code> is <code>"all"</code>, all possible estimates are calculated.
Otherwise, the specified estimates are calculated.</p>
<p>Several model sizes can also be specified.  If <code>comps</code> is missing (or
is <code>NULL</code>), <code>length(ncomp)</code> models are used, with <code>ncomp[1]</code>
components, ..., <code>ncomp[length(ncomp)]</code> components.  Otherwise, a
single model with the components <code>comps[1]</code>, ...,
<code>comps[length(comps)]</code> is used.  If <code>intercept</code> is <code>TRUE</code>, a
model with zero components is also used (in addition to the above).</p>
<p>The \(R^2\) values returned by <code>"R2"</code> are calculated as \(1 -
SSE/SST\), where \(SST\) is the (corrected) total sum of squares of the
response, and \(SSE\) is the sum of squared errors for either the fitted
values (i.e., the residual sum of squares), test set predictions or
cross-validated predictions (i.e., the \(PRESS\)).  For <code>estimate =
"train"</code>, this is equivalent to the squared correlation between the fitted
values and the response.  For <code>estimate = "train"</code>, the estimate is
often called the prediction \(R^2\).</p>
<p><code>mvrValstats</code> is a utility function that calculates the statistics
needed by <code>MSEP</code> and <code>R2</code>.  It is not intended to be used
interactively.  It accepts the same arguments as <code>MSEP</code> and <code>R2</code>.
However, the <code>estimate</code> argument must be specified explicitly: no
partial matching and no automatic choice is made.  The function simply
calculates the types of estimates it knows, and leaves the other untouched.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>mvrValstats</code> returns a list with components</p><dl><dt>SSE</dt>
<dd><p>three-dimensional array of SSE values.  The first dimension is
the different estimators, the second is the response variables and the third
is the models.</p></dd>
 <dt>SST</dt>
<dd><p>matrix of SST values.  The first dimension is the
different estimators and the second is the response variables.</p></dd>

<dt>nobj</dt>
<dd><p>a numeric vector giving the number of objects used for each
estimator.</p></dd>
 <dt>comps</dt>
<dd><p>the components specified, with <code>0</code> prepended
if <code>intercept</code> is <code>TRUE</code>.</p></dd>
 <dt>cumulative</dt>
<dd><p><code>TRUE</code> if
<code>comps</code> was <code>NULL</code> or not specified.</p></dd>

</dl><p>The other functions return an object of class <code>"mvrVal"</code>, with
components</p><dl><dt>val</dt>
<dd><p>three-dimensional array of estimates.  The
first dimension is the different estimators, the second is the response
variables and the third is the models.</p></dd>
 <dt>type</dt>
<dd><p><code>"MSEP"</code>,
<code>"RMSEP"</code> or <code>"R2"</code>.</p></dd>
 <dt>comps</dt>
<dd><p>the components specified, with
<code>0</code> prepended if <code>intercept</code> is <code>TRUE</code>.</p></dd>

<dt>cumulative</dt>
<dd><p><code>TRUE</code> if <code>comps</code> was <code>NULL</code> or not
specified.</p></dd>
 <dt>call</dt>
<dd><p>the function call</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Mevik, B.-H., Cederkvist, H. R. (2004) Mean Squared Error of
Prediction (MSEP) Estimates for Principal Component Regression (PCR) and
Partial Least Squares Regression (PLSR).  <em>Journal of Chemometrics</em>,
<b>18</b>(9), 422–429.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="mvr.html">mvr</a></code>, <code><a href="crossval.html">crossval</a></code>, <code><a href="mvrCv.html">mvrCv</a></code>,
<code><a href="validationplot.html">validationplot</a></code>, <code><a href="validationplot.html">plot.mvrVal</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ron Wehrens and Bjørn-Helge Mevik</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">oliveoil</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="mvr.html">plsr</a></span><span class="op">(</span><span class="va">sensory</span> <span class="op">~</span> <span class="va">chemical</span>, ncomp <span class="op">=</span> <span class="fl">4</span>, data <span class="op">=</span> <span class="va">oliveoil</span>, validation <span class="op">=</span> <span class="st">"LOO"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">RMSEP</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Response: yellow </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        (Intercept)  1 comps  2 comps  3 comps  4 comps</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CV            20.1    18.97    16.10    16.71    18.11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adjCV         20.1    18.91    16.03    16.61    17.93</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Response: green </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        (Intercept)  1 comps  2 comps  3 comps  4 comps</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CV           24.26    23.88    20.45    21.35    23.96</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adjCV        24.26    23.80    20.35    21.20    23.70</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Response: brown </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        (Intercept)  1 comps  2 comps  3 comps  4 comps</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CV           5.297    4.019    3.987    3.987    4.107</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adjCV        5.297    3.990    3.955    3.947    4.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Response: glossy </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        (Intercept)  1 comps  2 comps  3 comps  4 comps</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CV           6.391    5.109    5.161    5.571    6.446</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adjCV        6.391    5.087    5.129    5.522    6.363</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Response: transp </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        (Intercept)  1 comps  2 comps  3 comps  4 comps</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CV            8.58    7.258    7.158    7.665    8.794</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adjCV         8.58    7.232    7.118    7.607    8.691</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Response: syrup </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        (Intercept)  1 comps  2 comps  3 comps  4 comps</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CV           3.166    2.134    2.325    2.478    2.939</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adjCV        3.166    2.128    2.310    2.458    2.901</span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">R2</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span> <span class="co"># \dontrun{}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kristian Hovde Liland, Bjørn-Helge Mevik, Ron Wehrens.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

