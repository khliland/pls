<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Cross-validation — mvrCv • pls</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cross-validation — mvrCv"><meta name="description" content='Performs the cross-validation calculations for mvr.
This function is not meant to be called directly, but through the generic
functions pcr, plsr, cppls or mvr with the
argument validation set to "CV" or "LOO".  All
arguments to mvrCv can be specified in the generic function call.
If segments is a list, the arguments segment.type and
length.seg are ignored.  The elements of the list should be integer
vectors specifying the indices of the segments.  See
cvsegments for details.
Otherwise, segments of type segment.type are generated.  How many
segments to generate is selected by specifying the number of segments in
segments, or giving the segment length in length.seg.  If both
are specified, segments is ignored.
If jackknife is TRUE, jackknifed regression coefficients are
returned, which can be used for for variance estimation
(var.jack) or hypothesis testing (jack.test).
X and Y do not need to be centered.
Note that this function cannot be used in situations where \(X\) needs to
be recalculated for each segment (except for scaling by the standard
deviation), for instance with msc or other preprocessing.  For such
models, use the more general (but slower) function crossval.
Also note that if needed, the function will silently(!) reduce ncomp
to the maximal number of components that can be cross-validated, which is
\(n - l - 1\), where \(n\) is the number of observations and \(l\) is
the length of the longest segment.  The (possibly reduced) number of
components is returned as the component ncomp.
By default, the cross-validation will be performed serially.  However, it
can be done in parallel using functionality in the parallel
package by setting the option parallel in pls.options.
See pls.options for the different ways to specify the
parallelism.'><meta property="og:description" content='Performs the cross-validation calculations for mvr.
This function is not meant to be called directly, but through the generic
functions pcr, plsr, cppls or mvr with the
argument validation set to "CV" or "LOO".  All
arguments to mvrCv can be specified in the generic function call.
If segments is a list, the arguments segment.type and
length.seg are ignored.  The elements of the list should be integer
vectors specifying the indices of the segments.  See
cvsegments for details.
Otherwise, segments of type segment.type are generated.  How many
segments to generate is selected by specifying the number of segments in
segments, or giving the segment length in length.seg.  If both
are specified, segments is ignored.
If jackknife is TRUE, jackknifed regression coefficients are
returned, which can be used for for variance estimation
(var.jack) or hypothesis testing (jack.test).
X and Y do not need to be centered.
Note that this function cannot be used in situations where \(X\) needs to
be recalculated for each segment (except for scaling by the standard
deviation), for instance with msc or other preprocessing.  For such
models, use the more general (but slower) function crossval.
Also note that if needed, the function will silently(!) reduce ncomp
to the maximal number of components that can be cross-validated, which is
\(n - l - 1\), where \(n\) is the number of observations and \(l\) is
the length of the longest segment.  The (possibly reduced) number of
components is returned as the component ncomp.
By default, the cross-validation will be performed serially.  However, it
can be done in parallel using functionality in the parallel
package by setting the option parallel in pls.options.
See pls.options for the different ways to specify the
parallelism.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pls</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.9-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/pls-manual.html">Introduction to the pls Package</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/khliland/pls/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Cross-validation</h1>
      <small class="dont-index">Source: <a href="https://github.com/khliland/pls/blob/HEAD/R/crossval.R" class="external-link"><code>R/crossval.R</code></a></small>
      <div class="d-none name"><code>mvrCv.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs the cross-validation calculations for <code>mvr</code>.</p>
<p>This function is not meant to be called directly, but through the generic
functions <code>pcr</code>, <code>plsr</code>, <code>cppls</code> or <code>mvr</code> with the
argument <code>validation</code> set to <code>"CV"</code> or <code>"LOO"</code>.  All
arguments to <code>mvrCv</code> can be specified in the generic function call.</p>
<p>If <code>segments</code> is a list, the arguments <code>segment.type</code> and
<code>length.seg</code> are ignored.  The elements of the list should be integer
vectors specifying the indices of the segments.  See
<code><a href="cvsegments.html">cvsegments</a></code> for details.</p>
<p>Otherwise, segments of type <code>segment.type</code> are generated.  How many
segments to generate is selected by specifying the number of segments in
<code>segments</code>, or giving the segment length in <code>length.seg</code>.  If both
are specified, <code>segments</code> is ignored.</p>
<p>If <code>jackknife</code> is <code>TRUE</code>, jackknifed regression coefficients are
returned, which can be used for for variance estimation
(<code><a href="var.jack.html">var.jack</a></code>) or hypothesis testing (<code><a href="jack.test.html">jack.test</a></code>).</p>
<p><code>X</code> and <code>Y</code> do not need to be centered.</p>
<p>Note that this function cannot be used in situations where \(X\) needs to
be recalculated for each segment (except for scaling by the standard
deviation), for instance with <code>msc</code> or other preprocessing.  For such
models, use the more general (but slower) function <code><a href="crossval.html">crossval</a></code>.</p>
<p>Also note that if needed, the function will silently(!) reduce <code>ncomp</code>
to the maximal number of components that can be cross-validated, which is
\(n - l - 1\), where \(n\) is the number of observations and \(l\) is
the length of the longest segment.  The (possibly reduced) number of
components is returned as the component <code>ncomp</code>.</p>
<p>By default, the cross-validation will be performed serially.  However, it
can be done in parallel using functionality in the <code><a href="https://rdrr.io/r/parallel/parallel-package.html" class="external-link">parallel</a></code>
package by setting the option <code>parallel</code> in <code><a href="pls.options.html">pls.options</a></code>.
See <code><a href="pls.options.html">pls.options</a></code> for the different ways to specify the
parallelism.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mvrCv</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">Y</span>,</span>
<span>  <span class="va">ncomp</span>,</span>
<span>  Y.add <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="pls.options.html">pls.options</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">mvralg</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  segments <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  segment.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"random"</span>, <span class="st">"consecutive"</span>, <span class="st">"interleaved"</span><span class="op">)</span>,</span>
<span>  <span class="va">length.seg</span>,</span>
<span>  jackknife <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  trace <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a matrix of observations.  <code>NA</code>s and <code>Inf</code>s are not
allowed.</p></dd>


<dt id="arg-y">Y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>a vector or matrix of responses.  <code>NA</code>s and <code>Inf</code>s are
not allowed.</p></dd>


<dt id="arg-ncomp">ncomp<a class="anchor" aria-label="anchor" href="#arg-ncomp"></a></dt>
<dd><p>the number of components to be used in the modelling.</p></dd>


<dt id="arg-y-add">Y.add<a class="anchor" aria-label="anchor" href="#arg-y-add"></a></dt>
<dd><p>a vector or matrix of additional responses containing relevant
information about the observations.  Only used for <code>cppls</code>.</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>a vector of individual weights for the observations.  Only
used for <code>cppls</code>.  (Optional)</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>the multivariate regression method to be used.</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>logical.  If <code>TRUE</code>, the learning \(X\) data for each
segment is scaled by dividing each variable by its sample standard
deviation.  The prediction data is scaled by the same amount.</p></dd>


<dt id="arg-segments">segments<a class="anchor" aria-label="anchor" href="#arg-segments"></a></dt>
<dd><p>the number of segments to use, or a list with segments (see
below).</p></dd>


<dt id="arg-segment-type">segment.type<a class="anchor" aria-label="anchor" href="#arg-segment-type"></a></dt>
<dd><p>the type of segments to use.  Ignored if <code>segments</code>
is a list.</p></dd>


<dt id="arg-length-seg">length.seg<a class="anchor" aria-label="anchor" href="#arg-length-seg"></a></dt>
<dd><p>Positive integer.  The length of the segments to use.  If
specified, it overrides <code>segments</code> unless <code>segments</code> is a list.</p></dd>


<dt id="arg-jackknife">jackknife<a class="anchor" aria-label="anchor" href="#arg-jackknife"></a></dt>
<dd><p>logical.  Whether jackknifing of regression coefficients
should be performed.</p></dd>


<dt id="arg-trace">trace<a class="anchor" aria-label="anchor" href="#arg-trace"></a></dt>
<dd><p>logical; if <code>TRUE</code>, the segment number is printed for each
segment.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments, sent to the underlying fit function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the following components:</p>
<dl><dt>method</dt>
<dd><p>equals
<code>"CV"</code> for cross-validation.</p></dd>
 <dt>pred</dt>
<dd><p>an array with the
cross-validated predictions.</p></dd>
 <dt>coefficients</dt>
<dd><p>(only if <code>jackknife</code>
is <code>TRUE</code>) an array with the jackknifed regression coefficients.  The
dimensions correspond to the predictors, responses, number of components,
and segments, respectively.</p></dd>
 <dt>PRESS0</dt>
<dd><p>a vector of PRESS values (one for
each response variable) for a model with zero components, i.e., only the
intercept.</p></dd>
 <dt>PRESS</dt>
<dd><p>a matrix of PRESS values for models with 1,
..., <code>ncomp</code> components.  Each row corresponds to one response
variable.</p></dd>
 <dt>adj</dt>
<dd><p>a matrix of adjustment values for calculating bias
corrected MSEP.  <code>MSEP</code> uses this.</p></dd>
 <dt>segments</dt>
<dd><p>the list of
segments used in the cross-validation.</p></dd>
 <dt>ncomp</dt>
<dd><p>the actual number of
components used.</p></dd>
 <dt>gamma</dt>
<dd><p>if method <code>cppls</code> is used, gamma values
for the powers of each CV segment are returned.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The <code>PRESS0</code> is always cross-validated using leave-one-out
cross-validation.  This usually makes little difference in practice, but
should be fixed for correctness.</p>
<p>The current implementation of the jackknife stores all jackknife-replicates
of the regression coefficients, which can be very costly for large matrices.
This might change in a future version.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Mevik, B.-H., Cederkvist, H. R. (2004) Mean Squared Error of
Prediction (MSEP) Estimates for Principal Component Regression (PCR) and
Partial Least Squares Regression (PLSR).  <em>Journal of Chemometrics</em>,
<b>18</b>(9), 422–429.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="mvr.html">mvr</a></code> <code><a href="crossval.html">crossval</a></code> <code><a href="cvsegments.html">cvsegments</a></code>
<code><a href="mvrVal.html">MSEP</a></code> <code><a href="var.jack.html">var.jack</a></code> <code><a href="jack.test.html">jack.test</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ron Wehrens and Bjørn-Helge Mevik</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">yarn</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">yarn.pcr</span> <span class="op">&lt;-</span> <span class="fu"><a href="mvr.html">pcr</a></span><span class="op">(</span><span class="va">density</span> <span class="op">~</span> <span class="va">NIR</span>, <span class="fl">6</span>, data <span class="op">=</span> <span class="va">yarn</span>, validation <span class="op">=</span> <span class="st">"CV"</span>, segments <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="mvrVal.html">MSEP</a></span><span class="op">(</span><span class="va">yarn.pcr</span><span class="op">)</span><span class="op">)</span> <span class="co"># \dontrun{}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kristian Hovde Liland, Bjørn-Helge Mevik, Ron Wehrens.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

