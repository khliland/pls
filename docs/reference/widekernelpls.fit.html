<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Wide Kernel PLS (Rännar et al.) — widekernelpls.fit • pls</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Wide Kernel PLS (Rännar et al.) — widekernelpls.fit"><meta name="description" content="Fits a PLSR model with the wide kernel algorithm."><meta property="og:description" content="Fits a PLSR model with the wide kernel algorithm."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pls</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.9-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/pls-manual.html">Introduction to the pls Package</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/khliland/pls/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Wide Kernel PLS (Rännar et al.)</h1>
      <small class="dont-index">Source: <a href="https://github.com/khliland/pls/blob/HEAD/R/widekernelpls.fit.R" class="external-link"><code>R/widekernelpls.fit.R</code></a></small>
      <div class="d-none name"><code>widekernelpls.fit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits a PLSR model with the wide kernel algorithm.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">widekernelpls.fit</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">Y</span>,</span>
<span>  <span class="va">ncomp</span>,</span>
<span>  center <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  stripped <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  tol <span class="op">=</span> <span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">^</span><span class="fl">0.5</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a matrix of observations.  <code>NA</code>s and <code>Inf</code>s are not
allowed.</p></dd>


<dt id="arg-y">Y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>a vector or matrix of responses.  <code>NA</code>s and <code>Inf</code>s are
not allowed.</p></dd>


<dt id="arg-ncomp">ncomp<a class="anchor" aria-label="anchor" href="#arg-ncomp"></a></dt>
<dd><p>the number of components to be used in the modelling.</p></dd>


<dt id="arg-center">center<a class="anchor" aria-label="anchor" href="#arg-center"></a></dt>
<dd><p>logical, determines if the \(X\) and \(Y\) matrices are
mean centered or not. Default is to perform mean centering.</p></dd>


<dt id="arg-stripped">stripped<a class="anchor" aria-label="anchor" href="#arg-stripped"></a></dt>
<dd><p>logical.  If <code>TRUE</code> the calculations are stripped as
much as possible for speed; this is meant for use with cross-validation or
simulations when only the coefficients are needed.  Defaults to
<code>FALSE</code>.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>numeric.  The tolerance used for determining convergence in the
algorithm.</p></dd>


<dt id="arg-maxit">maxit<a class="anchor" aria-label="anchor" href="#arg-maxit"></a></dt>
<dd><p>positive integer.  The maximal number of iterations used in the
internal Eigenvector calculation.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>other arguments.  Currently ignored.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing the following components is returned:</p>
<dl><dt>coefficients</dt>
<dd><p>an array of regression coefficients for 1, ...,
<code>ncomp</code> components.  The dimensions of <code>coefficients</code> are
<code>c(nvar, npred, ncomp)</code> with <code>nvar</code> the number of <code>X</code>
variables and <code>npred</code> the number of variables to be predicted in
<code>Y</code>.</p></dd>
 <dt>scores</dt>
<dd><p>a matrix of scores.</p></dd>
 <dt>loadings</dt>
<dd><p>a matrix of
loadings.</p></dd>
 <dt>loading.weights</dt>
<dd><p>a matrix of loading weights.</p></dd>

<dt>Yscores</dt>
<dd><p>a matrix of Y-scores.</p></dd>
 <dt>Yloadings</dt>
<dd><p>a matrix of
Y-loadings.</p></dd>
 <dt>projection</dt>
<dd><p>the projection matrix used to convert X to
scores.</p></dd>
 <dt>Xmeans</dt>
<dd><p>a vector of means of the X variables.</p></dd>

<dt>Ymeans</dt>
<dd><p>a vector of means of the Y variables.</p></dd>
 <dt>fitted.values</dt>
<dd><p>an
array of fitted values.  The dimensions of <code>fitted.values</code> are
<code>c(nobj, npred, ncomp)</code> with <code>nobj</code> the number samples and
<code>npred</code> the number of Y variables.</p></dd>
 <dt>residuals</dt>
<dd><p>an array of
regression residuals.  It has the same dimensions as <code>fitted.values</code>.</p></dd>

<dt>Xvar</dt>
<dd><p>a vector with the amount of X-variance explained by each
component.</p></dd>
 <dt>Xtotvar</dt>
<dd><p>Total variance in <code>X</code>.</p></dd>


</dl><p>If <code>stripped</code> is <code>TRUE</code>, only the components <code>coefficients</code>,
<code>Xmeans</code> and <code>Ymeans</code> are returned.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function should not be called directly, but through the generic
functions <code>plsr</code> or <code>mvr</code> with the argument
<code>method="widekernelpls"</code>.  The wide kernel PLS algorithm is efficient
when the number of variables is (much) larger than the number of
observations.  For very wide <code>X</code>, for instance 12x18000, it can be
twice as fast as <code><a href="kernelpls.fit.html">kernelpls.fit</a></code> and <code><a href="simpls.fit.html">simpls.fit</a></code>.
For other matrices, however, it can be much slower.  The results are equal
to the results of the NIPALS algorithm.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The current implementation has not undergone extensive testing yet,
and should perhaps be regarded as experimental.  Specifically, the internal
Eigenvector calculation does not always converge in extreme cases where the
Eigenvalue is close to zero.  However, when it does converge, it always
converges to the same results as <code><a href="kernelpls.fit.html">kernelpls.fit</a></code>, up to
numerical inacurracies.</p>
<p>The algorithm also has a bit of overhead, so when the number of observations
is moderately high, <code><a href="kernelpls.fit.html">kernelpls.fit</a></code> can be faster even if the
number of predictors is much higher.  The relative speed of the algorithms
can also depend greatly on which BLAS and/or LAPACK library is linked
against.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Rännar, S., Lindgren, F., Geladi, P. and Wold, S. (1994) A PLS
Kernel Algorithm for Data Sets with Many Variables and Fewer Objects.  Part
1: Theory and Algorithm.  <em>Journal of Chemometrics</em>, <b>8</b>,
111–125.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="mvr.html">mvr</a></code> <code><a href="mvr.html">plsr</a></code> <code><a href="mvr.html">cppls</a></code>
<code><a href="mvr.html">pcr</a></code> <code><a href="kernelpls.fit.html">kernelpls.fit</a></code> <code><a href="simpls.fit.html">simpls.fit</a></code>
<code><a href="oscorespls.fit.html">oscorespls.fit</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Bjørn-Helge Mevik</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kristian Hovde Liland, Bjørn-Helge Mevik, Ron Wehrens.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

