<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Jackknife Variance Estimates of Regression Coefficients — var.jack • pls</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Jackknife Variance Estimates of Regression Coefficients — var.jack"><meta name="description" content="Calculates jackknife variance or covariance estimates of regression
coefficients.
The original (Tukey) jackknife variance estimator is defined as \((g-1)/g
\sum_{i=1}^g(\tilde\beta_{-i} - \bar\beta)^2\), where \(g\) is the number
of segments, \(\tilde\beta_{-i}\) is the estimated coefficient when
segment \(i\) is left out (called the jackknife replicates), and
\(\bar\beta\) is the mean of the \(\tilde\beta_{-i}\).  The most common
case is delete-one jackknife, with \(g = n\), the number of observations.
This is the definition var.jack uses by default.
However, Martens and Martens (2000) defined the estimator as \((g-1)/g
\sum_{i=1}^g(\tilde\beta_{-i} - \hat\beta)^2\), where \(\hat\beta\) is the
coefficient estimate using the entire data set.  I.e., they use the original
fitted coefficients instead of the mean of the jackknife replicates.  Most
(all?) other jackknife implementations for PLSR use this estimator.
var.jack can be made to use this definition with use.mean =
FALSE.  In practice, the difference should be small if the number of
observations is sufficiently large.  Note, however, that all theoretical
results about the jackknife refer to the `proper' definition.  (Also note
that this option might disappear in a future version.)"><meta property="og:description" content="Calculates jackknife variance or covariance estimates of regression
coefficients.
The original (Tukey) jackknife variance estimator is defined as \((g-1)/g
\sum_{i=1}^g(\tilde\beta_{-i} - \bar\beta)^2\), where \(g\) is the number
of segments, \(\tilde\beta_{-i}\) is the estimated coefficient when
segment \(i\) is left out (called the jackknife replicates), and
\(\bar\beta\) is the mean of the \(\tilde\beta_{-i}\).  The most common
case is delete-one jackknife, with \(g = n\), the number of observations.
This is the definition var.jack uses by default.
However, Martens and Martens (2000) defined the estimator as \((g-1)/g
\sum_{i=1}^g(\tilde\beta_{-i} - \hat\beta)^2\), where \(\hat\beta\) is the
coefficient estimate using the entire data set.  I.e., they use the original
fitted coefficients instead of the mean of the jackknife replicates.  Most
(all?) other jackknife implementations for PLSR use this estimator.
var.jack can be made to use this definition with use.mean =
FALSE.  In practice, the difference should be small if the number of
observations is sufficiently large.  Note, however, that all theoretical
results about the jackknife refer to the `proper' definition.  (Also note
that this option might disappear in a future version.)"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pls</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.9-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/khliland/pls/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Jackknife Variance Estimates of Regression Coefficients</h1>
      <small class="dont-index">Source: <a href="https://github.com/khliland/pls/blob/HEAD/R/jackknife.R" class="external-link"><code>R/jackknife.R</code></a></small>
      <div class="d-none name"><code>var.jack.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates jackknife variance or covariance estimates of regression
coefficients.</p>
<p>The original (Tukey) jackknife variance estimator is defined as \((g-1)/g
\sum_{i=1}^g(\tilde\beta_{-i} - \bar\beta)^2\), where \(g\) is the number
of segments, \(\tilde\beta_{-i}\) is the estimated coefficient when
segment \(i\) is left out (called the jackknife replicates), and
\(\bar\beta\) is the mean of the \(\tilde\beta_{-i}\).  The most common
case is delete-one jackknife, with \(g = n\), the number of observations.</p>
<p>This is the definition <code>var.jack</code> uses by default.</p>
<p>However, Martens and Martens (2000) defined the estimator as \((g-1)/g
\sum_{i=1}^g(\tilde\beta_{-i} - \hat\beta)^2\), where \(\hat\beta\) is the
coefficient estimate using the entire data set.  I.e., they use the original
fitted coefficients instead of the mean of the jackknife replicates.  Most
(all?) other jackknife implementations for PLSR use this estimator.
<code>var.jack</code> can be made to use this definition with <code>use.mean =
FALSE</code>.  In practice, the difference should be small if the number of
observations is sufficiently large.  Note, however, that all theoretical
results about the jackknife refer to the `proper' definition.  (Also note
that this option might disappear in a future version.)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">var.jack</span><span class="op">(</span><span class="va">object</span>, ncomp <span class="op">=</span> <span class="va">object</span><span class="op">$</span><span class="va">ncomp</span>, covariance <span class="op">=</span> <span class="cn">FALSE</span>, use.mean <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>an <code>mvr</code> object.  A cross-validated model fitted with
<code>jackknife = TRUE</code>.</p></dd>


<dt id="arg-ncomp">ncomp<a class="anchor" aria-label="anchor" href="#arg-ncomp"></a></dt>
<dd><p>the number of components to use for estimating the
(co)variances</p></dd>


<dt id="arg-covariance">covariance<a class="anchor" aria-label="anchor" href="#arg-covariance"></a></dt>
<dd><p>logical.  If <code>TRUE</code>, covariances are calculated;
otherwise only variances.  The default is <code>FALSE</code>.</p></dd>


<dt id="arg-use-mean">use.mean<a class="anchor" aria-label="anchor" href="#arg-use-mean"></a></dt>
<dd><p>logical.  If <code>TRUE</code> (default), the mean coefficients
are used when estimating the (co)variances; otherwise the coefficients from
a model fitted to the entire data set.  See Details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>covariance</code> is <code>FALSE</code>, an \(p\times q \times c\)
array of variance estimates, where \(p\) is the number of predictors,
\(q\) is the number of responses, and \(c\) is the number of components.</p>
<p>If <code>covariance</code> id <code>TRUE</code>, an \(pq\times pq \times c\) array of
variance-covariance estimates.</p>
    </div>
    <div class="section level2">
    <h2 id="warning">Warning<a class="anchor" aria-label="anchor" href="#warning"></a></h2>
    <p>Note that the Tukey jackknife variance estimator is not
unbiased for the variance of regression coefficients (Hinkley 1977).  The
bias depends on the \(X\) matrix.  For ordinary least squares regression
(OLSR), the bias can be calculated, and depends on the number of
observations \(n\) and the number of parameters \(k\) in the mode.  For
the common case of an orthogonal design matrix with \(\pm 1\) levels,
the delete-one jackknife estimate equals \((n-1)/(n-k)\) times the
classical variance estimate for the regression coefficients in OLSR.
Similar expressions hold for delete-d estimates.  Modifications have been
proposed to reduce or eliminate the bias for the OLSR case, however, they
depend on the number of parameters used in the model.  See e.g. Hinkley
(1977) or Wu (1986).</p>
<p>Thus, the results of <code>var.jack</code> should be used with caution.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Tukey J.W. (1958) Bias and Confidence in Not-quite Large
Samples. (Abstract of Preliminary Report).  <em>Annals of Mathematical
Statistics</em>, <b>29</b>(2), 614.</p>
<p>Martens H. and Martens M. (2000) Modified Jack-knife Estimation of Parameter
Uncertainty in Bilinear Modelling by Partial Least Squares Regression
(PLSR).  <em>Food Quality and Preference</em>, <b>11</b>, 5–16.</p>
<p>Hinkley D.V. (1977), Jackknifing in Unbalanced Situations.
<em>Technometrics</em>, <b>19</b>(3), 285–292.</p>
<p>Wu C.F.J. (1986) Jackknife, Bootstrap and Other Resampling Methods in
Regression Analysis.  <em>Te Annals of Statistics</em>, <b>14</b>(4),
1261–1295.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="mvrCv.html">mvrCv</a></code>, <code><a href="jack.test.html">jack.test</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Bjørn-Helge Mevik</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">oliveoil</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="mvr.html">pcr</a></span><span class="op">(</span><span class="va">sensory</span> <span class="op">~</span> <span class="va">chemical</span>, data <span class="op">=</span> <span class="va">oliveoil</span>, validation <span class="op">=</span> <span class="st">"LOO"</span>,</span></span>
<span class="r-in"><span>           jackknife <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">var.jack</span><span class="op">(</span><span class="va">mod</span>, ncomp <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , 2 comps</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                yellow        green        brown       glossy      transp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Acidity  1024.4116919 1589.2686000 1.750141e+01 42.522264128 73.50823993</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Peroxide    3.4451819    5.8716926 3.227187e-01  0.273051034  0.52181445</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> K232      583.6428901  961.3757680 2.190286e+01 22.819112503 69.31594523</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> K270        9.4454718   14.8484347 3.551073e-02  0.218596282  0.48383108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DK          0.1163998    0.1884952 9.368976e-04  0.005818676  0.01191753</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 syrup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Acidity  8.6885127205</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Peroxide 0.0171447602</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> K232     0.7877230726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> K270     0.0352534553</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DK       0.0004922534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kristian Hovde Liland, Bjørn-Helge Mevik, Ron Wehrens.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

