<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Extract Information From a Fitted PLSR or PCR Model — coef.mvr • pls</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extract Information From a Fitted PLSR or PCR Model — coef.mvr"><meta name="description" content="Functions to extract information from mvr objects: Regression
coefficients, fitted values, residuals, the model frame, the model matrix,
names of the variables and components, and the \(X\) variance explained by
the components."><meta property="og:description" content="Functions to extract information from mvr objects: Regression
coefficients, fitted values, residuals, the model frame, the model matrix,
names of the variables and components, and the \(X\) variance explained by
the components."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pls</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.9-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/khliland/pls/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Extract Information From a Fitted PLSR or PCR Model</h1>
      <small class="dont-index">Source: <a href="https://github.com/khliland/pls/blob/HEAD/R/extract.R" class="external-link"><code>R/extract.R</code></a></small>
      <div class="d-none name"><code>coef.mvr.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Functions to extract information from <code>mvr</code> objects: Regression
coefficients, fitted values, residuals, the model frame, the model matrix,
names of the variables and components, and the \(X\) variance explained by
the components.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'mvr'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">object</span>, ncomp <span class="op">=</span> <span class="va">object</span><span class="op">$</span><span class="va">ncomp</span>, <span class="va">comps</span>, intercept <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'mvr'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'mvr'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'mvr'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/model.frame.html" class="external-link">model.frame</a></span><span class="op">(</span><span class="va">formula</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'mvr'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">respnames</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">prednames</span><span class="op">(</span><span class="va">object</span>, intercept <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">compnames</span><span class="op">(</span><span class="va">object</span>, <span class="va">comps</span>, explvar <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">explvar</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object-formula">object, formula<a class="anchor" aria-label="anchor" href="#arg-object-formula"></a></dt>
<dd><p>an <code>mvr</code> object.  The fitted model.</p></dd>


<dt id="arg-ncomp-comps">ncomp, comps<a class="anchor" aria-label="anchor" href="#arg-ncomp-comps"></a></dt>
<dd><p>vector of positive integers.  The components to include
in the coefficients or to extract the names of.  See below.</p></dd>


<dt id="arg-intercept">intercept<a class="anchor" aria-label="anchor" href="#arg-intercept"></a></dt>
<dd><p>logical.  Whether coefficients for the intercept should be
included.  Ignored if <code>comps</code> is specified.  Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>other arguments sent to underlying functions.  Currently only
used for <code>model.frame.mvr</code> and <code>model.matrix.mvr</code>.</p></dd>


<dt id="arg-explvar">explvar<a class="anchor" aria-label="anchor" href="#arg-explvar"></a></dt>
<dd><p>logical.  Whether the explained \(X\) variance should be
appended to the component names.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>coef.mvr</code> returns an array of regression coefficients.</p>
<p><code>fitted.mvr</code> returns an array with fitted values.</p>
<p><code>residuals.mvr</code> returns an array with residuals.</p>
<p><code>model.frame.mvr</code> returns a data frame.</p>
<p><code>model.matrix.mvr</code> returns the \(X\) matrix.</p>
<p><code>prednames</code>, <code>respnames</code> and <code>compnames</code> return a character
vector with the corresponding names.</p>
<p><code>explvar</code> returns a numeric vector with the explained variances, or
<code>NULL</code> if not available.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>These functions are mostly used inside other functions.  (Functions
<code>coef.mvr</code>, <code>fitted.mvr</code> and <code>residuals.mvr</code> are usually
called through their generic functions <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></code>,
<code><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></code> and <code><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></code>, respectively.)</p>
<p><code>coef.mvr</code> is used to extract the regression coefficients of a model,
i.e. the \(B\) in \(y = XB\) (for the \(Q\) in \(y = TQ\) where
\(T\) is the scores, see <code><a href="scores.html">Yloadings</a></code>).  An array of dimension
<code>c(nxvar, nyvar, length(ncomp))</code> or <code>c(nxvar, nyvar,
length(comps))</code> is returned.</p>
<p>If <code>comps</code> is missing (or is <code>NULL</code>), <code>coef()[,,ncomp[i]]</code>
are the coefficients for models with <code>ncomp[i]</code> components, for \(i
= 1, \ldots, length(ncomp)\).  Also, if <code>intercept = TRUE</code>, the first
dimension is \(nxvar + 1\), with the intercept coefficients as the first
row.</p>
<p>If <code>comps</code> is given, however, <code>coef()[,,comps[i]]</code> are the
coefficients for a model with only the component <code>comps[i]</code>, i.e. the
contribution of the component <code>comps[i]</code> on the regression
coefficients.</p>
<p><code>fitted.mvr</code> and <code>residuals.mvr</code> return the fitted values and
residuals, respectively.  If the model was fitted with <code>na.action =
na.exclude</code> (or after setting the default <code>na.action</code> to
<code>"na.exclude"</code> with <code><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></code>), the fitted values (or
residuals) corresponding to excluded observations are returned as <code>NA</code>;
otherwise, they are omitted.</p>
<p><code>model.frame.mvr</code> returns the model frame; i.e. a data frame with all
variables neccessary to generate the model matrix.  See
<code><a href="https://rdrr.io/r/stats/model.frame.html" class="external-link">model.frame</a></code> for details.</p>
<p><code>model.matrix.mvr</code> returns the (possibly coded) matrix used as \(X\)
in the fitting.  See <code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></code> for details.</p>
<p><code>prednames</code>, <code>respnames</code> and <code>compnames</code> extract the names of
the \(X\) variables, responses and components, respectively.  With
<code>intercept = TRUE</code> in <code>prednames</code>, the name of the intercept
variable (i.e. <code>"(Intercept)"</code>) is returned as well.  <code>compnames</code>
can also extract component names from score and loading matrices.  If
<code>explvar = TRUE</code> in <code>compnames</code>, the explained variance for each
component (if available) is appended to the component names.  For optimal
formatting of the explained variances when not all components are to be
used, one should specify the desired components with the argument
<code>comps</code>.</p>
<p><code>explvar</code> extracts the amount of \(X\) variance (in per cent)
explained by each component in the model.  It can also handle score and
loading matrices returned by <code><a href="scores.html">scores</a></code> and
<code><a href="scores.html">loadings</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="mvr.html">mvr</a></code>, <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></code>, <code><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></code>,
<code><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></code>, <code><a href="https://rdrr.io/r/stats/model.frame.html" class="external-link">model.frame</a></code>,
<code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></code>, <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ron Wehrens and Bjørn-Helge Mevik</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">yarn</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="mvr.html">pcr</a></span><span class="op">(</span><span class="va">density</span> <span class="op">~</span> <span class="va">NIR</span>, data <span class="op">=</span> <span class="va">yarn</span><span class="op">[</span><span class="va">yarn</span><span class="op">$</span><span class="va">train</span>,<span class="op">]</span>, ncomp <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod</span>, ncomp <span class="op">=</span> <span class="fl">3</span>, intercept <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## A manual predict method:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/drop.html" class="external-link">drop</a></span><span class="op">(</span><span class="va">B</span><span class="op">[</span><span class="fl">1</span>,,<span class="op">]</span> <span class="op">+</span> <span class="va">yarn</span><span class="op">$</span><span class="va">NIR</span><span class="op">[</span><span class="op">!</span><span class="va">yarn</span><span class="op">$</span><span class="va">train</span>,<span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">B</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>,,<span class="op">]</span><span class="op">)</span> <span class="op">==</span></span></span>
<span class="r-in"><span>          <span class="fu"><a href="https://rdrr.io/r/base/drop.html" class="external-link">drop</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod</span>, ncomp <span class="op">=</span> <span class="fl">3</span>, newdata <span class="op">=</span> <span class="va">yarn</span><span class="op">[</span><span class="op">!</span><span class="va">yarn</span><span class="op">$</span><span class="va">train</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Note the difference in formatting:</span></span></span>
<span class="r-in"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="mvr.html">pcr</a></span><span class="op">(</span><span class="va">density</span> <span class="op">~</span> <span class="va">NIR</span>, data <span class="op">=</span> <span class="va">yarn</span><span class="op">[</span><span class="va">yarn</span><span class="op">$</span><span class="va">train</span>,<span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">compnames</span><span class="op">(</span><span class="va">mod2</span>, explvar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Comp 1 (5.2e+01 %)" "Comp 2 (4.7e+01 %)" "Comp 3 (7.3e-01 %)"</span>
<span class="r-in"><span><span class="fu">compnames</span><span class="op">(</span><span class="va">mod2</span>, comps <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, explvar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Comp 1 (52.05 %)" "Comp 2 (46.73 %)" "Comp 3 (0.73 %)" </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kristian Hovde Liland, Bjørn-Helge Mevik, Ron Wehrens.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

