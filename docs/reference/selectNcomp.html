<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Suggestions for the optimal number of components in PCR and PLSR models — selectNcomp • pls</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Suggestions for the optimal number of components in PCR and PLSR models — selectNcomp"><meta name="description" content="Choosing the best number of components in PCR and PLSR models is difficult
and usually done on the basis of visual inspection of the validation plots.
In cases where large numbers of models are built this choice needs to be
automated. This function implements two proposals, one based on
randomization (permutation) testing, and an approach based on the standard
error of the cross-validation residuals."><meta property="og:description" content="Choosing the best number of components in PCR and PLSR models is difficult
and usually done on the basis of visual inspection of the validation plots.
In cases where large numbers of models are built this choice needs to be
automated. This function implements two proposals, one based on
randomization (permutation) testing, and an approach based on the standard
error of the cross-validation residuals."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pls</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.9-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/pls-manual.html">Introduction to the pls Package</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/khliland/pls/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Suggestions for the optimal number of components in PCR and PLSR models</h1>
      <small class="dont-index">Source: <a href="https://github.com/khliland/pls/blob/HEAD/R/ncomp.R" class="external-link"><code>R/ncomp.R</code></a></small>
      <div class="d-none name"><code>selectNcomp.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Choosing the best number of components in PCR and PLSR models is difficult
and usually done on the basis of visual inspection of the validation plots.
In cases where large numbers of models are built this choice needs to be
automated. This function implements two proposals, one based on
randomization (permutation) testing, and an approach based on the standard
error of the cross-validation residuals.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">selectNcomp</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"randomization"</span>, <span class="st">"onesigma"</span><span class="op">)</span>,</span>
<span>  nperm <span class="op">=</span> <span class="fl">999</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  ncomp <span class="op">=</span> <span class="va">object</span><span class="op">$</span><span class="va">ncomp</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>an <code>mvr</code> object.  The fitted model. It should contain a
<code>validation</code> element.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>character string, indicating the heuristic to use.</p></dd>


<dt id="arg-nperm">nperm<a class="anchor" aria-label="anchor" href="#arg-nperm"></a></dt>
<dd><p>number of permutations in the <code>"randomization"</code> approach -
not used in the <code>"onesigma"</code> approach.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>cutoff for p values in the <code>"randomization"</code> approach -
not used in the <code>"onesigma"</code> approach.</p></dd>


<dt id="arg-ncomp">ncomp<a class="anchor" aria-label="anchor" href="#arg-ncomp"></a></dt>
<dd><p>maximum number of components to consider when determining the
global minimum in the cross-validation curve.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>whether or not to show a cross-validation plot. The plot for the
<code>"randomization"</code> approach shows models that do not differ
significantly from the global RMSEP minimum with open circles; the
<code>"onesigma"</code> approach shows the one-sigma bands around the RMSEP
values. In both cases, the selection is indicated with a blue dashed line.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further plotting arguments, e.g., to add a title to the plot,
or to limit the plotting range.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A number indicating the suggested number of components in the model.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>In both approaches the results of cross-validation are used, so the model
should have been calculated with some form of cross-validation. First, the
absolute minimum in the CV curve is determined (considering only the first
ncomp components), leading to the reference model. The randomization test
approach (Van der Voet, 1994) checks whether the squared prediction errors
of models with fewer components are significantly larger than in the
reference model. This leads for each model considered to a \(p\) value;
the smallest model not significantly worse than the reference model is
returned as the selected one.</p>
<p>The approach <code>"onesigma"</code> simply returns the first model where the
optimal CV is within one standard error of the absolute optimum (Hastie,
Tibshirani and Friedman, 2009). Note that here we simply use the standard
deviation of the cross-validation residuals, in line with the procedure used
to calculate the error measure itself. Some other packages implementing
similar procedures (such as <code>glmnet</code>) calculate an error measure for
each validation segment separately and use the average as the final
estimate. In such cases the standard error across segments is the relevant
measure of spread. For LOO, the two procedures are identical. In other forms
of validation, small differences will occur.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Van der Voet, H. (1994) Comparing the predictive accuracy of
models using a simple randomization test. Chemom. Intell. Lab. Syst. 25 (2),
313-323</p>
<p>Hastie, T., Friedman, J. and Tibshirani, R. The Elements of Statistical
Learning: data mining, inference, and prediction, Springer (2013), 10th
printing with corrections, paragraph 7.10.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="mvr.html">mvr</a></code>, <code><a href="summary.mvr.html">summary.mvr</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ron Wehrens, Hilko van der Voet and Gerie van der Heijden</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">yarn</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">yarn.pls</span> <span class="op">&lt;-</span> <span class="fu"><a href="mvr.html">plsr</a></span><span class="op">(</span><span class="va">density</span> <span class="op">~</span> <span class="va">NIR</span>, data <span class="op">=</span> <span class="va">yarn</span>, scale <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                 ncomp <span class="op">=</span> <span class="fl">20</span>, validation <span class="op">=</span> <span class="st">"LOO"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">selectNcomp</span><span class="op">(</span><span class="va">yarn.pls</span>, <span class="st">"onesigma"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="selectNcomp-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9</span>
<span class="r-in"><span><span class="fu">selectNcomp</span><span class="op">(</span><span class="va">yarn.pls</span>, <span class="st">"randomization"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="selectNcomp-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-in"><span><span class="fu">selectNcomp</span><span class="op">(</span><span class="va">yarn.pls</span>, <span class="st">"randomization"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>            ncomp <span class="op">=</span> <span class="fl">10</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="selectNcomp-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kristian Hovde Liland, Bjørn-Helge Mevik, Ron Wehrens.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

